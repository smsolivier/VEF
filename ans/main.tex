\documentclass{anstrans}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Eddington Acceleration}
\author{Samuel S. Olivier*}

\institute{Department of Nuclear Engineering, Texas A\&M University, College Station, TX 77843}

\email{smsolivier@tamu.edu}


%%%% packages and definitions (optional)
\usepackage{graphicx} % allows inclusion of graphics
\usepackage{booktabs} % nice rules (thick lines) for tables
\usepackage{microtype} % improves typography for PDF

\usepackage{xspace}
\usepackage{siunitx}

\newcommand{\SN}{S$_N$\xspace}
\renewcommand{\vec}[1]{\bm{#1}} %vector is bold italic
\newcommand{\vd}{\bm{\cdot}} % slightly bold vector dot
\newcommand{\grad}{\vec{\nabla}} % gradient
\newcommand{\ud}{\mathop{}\!\mathrm{d}} % upright derivative symbol
\newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\dderiv}[2]{\frac{\ud #1}{\ud #2}}
\newcommand{\edd}{\langle \mu^2 \rangle} 

% add section on MHFEM system 
% order of accuracy of accelerated system 

\begin{document}
\section{Introduction}
	% Two of the most challenging computational tasks are radiation transport and hydrodynamics. 
	One of the most challenging computational tasks is simulating the interaction of radiation with matter. 
	A full description of a particle in flight includes three spatial variables ($x$,$y$ and $z$), two angular or direction of flight variables ($\mu =$ the cosine of the polar angle and $\gamma =$ the azimuthal angle), one energy variable ($E$) and one time variable ($t$). Numerical solutions require discretizing all seven variables leading to immense systems of algebraic equations. In addition, material properties can lead to vastly different solution behaviors making generalized numerical methods for radiation transport difficult to attain \cite{adams}. 

	% The conservation of mass, momentum and energy in hydrodynamics simulations leads to a hyperbolic system of partial differential equations dependent on the time derivatives of velocity and two state variables. This results in five variables but only three equations leading to the requirement of additional equations to reach problem closure \cite{hydro}. 

	% Radiation transport and hydrodynamics can be combined using operator splitting, where the radiation transport and hydrodynamics 

	Lawrence Livermore National Laboratory (LLNL) is developing a high--order radiation--hydrodynamics code. The hydrodynamics portion is discretized using the Mixed--Hybrid Finite Element Method (MHFEM), where values are taken to be constant within a cell with discontinuous jumps at both cell edges \cite{mhfem}. MHFEM is particularly suited for hydrodynamics but not for radiation transport. This work seeks to develop an acceleration scheme capable of robustly reducing the number of iterations in Discrete Ordinates Source Iteration calculations while being compatible with MHFEM multiphysics.   

\section{Background}
	The steady--state, mono--energetic, isotropically--scattering, fixed--source Linear Boltzmann Equation in planar geometry is: 
		\begin{equation} \label{eq:bte}
			\mu \pderiv{\psi}{x}(x, \mu) + \Sigma_t(x) \psi(x,\mu) = 
			\frac{\Sigma_s(x)}{2} \int_{-1}^{1} \psi(x, \mu') d\mu' + \frac{Q(x)}{2}
		\end{equation}
	where $\mu = \cos\theta$ is the cosine of the angle of flight $\theta$ relative to the $x$--axis, $\Sigma_t(x)$ and $\Sigma_s(x)$ the total and scattering macroscopic cross sections, $Q(x)$ the isotropic fixed--source and $\psi(x, \mu)$ the angular flux \cite{adams}. In the Discrete Ordinates (\SN) angular discretization, $\mu$ takes discrete values from an $N$--point Gauss quadrature rule. The scalar flux, $\phi(x)$, is then 
		\begin{equation} \label{eq:quad}
			\phi(x) = \int_{-1}^1 \psi(x, \mu) \ud\mu 
				\xrightarrow{\text{S}_N} \sum_{n=1}^N w_n \psi_n(x)
		\end{equation}
	where $\psi_n(x) = \psi(x,\mu_n)$ and $w_n$ the quadrature weights corresponding to each $\mu_n$ \cite{llnl}. The \SN equations are then 
		\begin{equation} \label{eq:sn}
			\mu_n \dderiv{\psi_n}{x}(x) + \Sigma_t(x) \psi_n(x) = 
			\frac{\Sigma_s(x)}{2} \sum_{n=1}^N w_n \psi_n(x) + \frac{Q(x)}{2} 
		\end{equation}
	for $n = 1, 2, \dots, N$. 

	In the Source Iteration (SI) solution method, the right hand side of Eq. \ref{eq:sn} is lagged. In other words, 
		\begin{equation} \label{eq:si}
			\mu_n \dderiv{\psi_n^{\ell+1}}{x}(x) + \Sigma_t(x) \psi_n^{\ell+1}(x) = 
			\frac{\Sigma_s(x)}{2} \sum_{n=1}^N w_n \psi_n^\ell(x) + \frac{Q(x)}{2}. 
		\end{equation}
	Equation \ref{eq:si} is iterated until 
		\begin{equation} \label{eq:converg}
			\frac{\|\phi^{\ell+1}(x) - \phi^{\ell}(x)\|}{\|\phi^{\ell+1}(x)\|} < \epsilon
		\end{equation}
	where $\phi(x)$ is defined in Eq. \ref{eq:quad} and $\epsilon$ is a sufficiently small tolerance. If the initial guess for the scalar flux, $\phi^0(x)$, is zero for all values of $x$, then $\phi^\ell(x)$ is the scalar flux of particles that have undergone $\ell - 1$ collisions \cite{adams}. Thus, the number of iterations until convergence is directly linked to the number of collisions in a particle's lifetime. Typically, SI becomes increasingly slow to converge as the ratio of $\Sigma_s$ to $\Sigma_t$ approaches unity and the amount of particle leakage from the system goes to zero. SI is slowest in highly scattering systems with small losses to absorption and particle leakage. 

	Fortunately, the regime where SI is slow to converge is also the regime where Diffusion Theory is most accurate. A popular method for accelerating SI is Diffusion Synthetic Acceleration (DSA) where a transport sweep is conducted and then a diffusion solve is used to generate a correction factor. DSA requires carefully differencing the \SN and diffusion steps in a consistent manner to prevent instability in highly scattering media with coarse spatial grids \cite{alcouffe}. DSA is not applicable in the setting of this presentation due to the incompatibility of MHFEM and \SN. A new acceleration method is needed that avoids the consistency pitfall of DSA. 

\section{Eddington Acceleration}
	The zeroth and first angular moments of Eq. \ref{eq:bte} are 
		\begin{subequations} 
		\begin{equation} \label{eq:zero}
			\dderiv{}{x} J(x) + \Sigma_a(x) \phi(x) = Q(x) 
		\end{equation} 
		\begin{equation} \label{eq:first}
			\frac{\ud}{\ud x} \edd(x) \phi(x) + \Sigma_t(x) J(x) = 0  
		\end{equation}
		\end{subequations}
	where $J = \int_{-1}^{1} \mu \ \psi(x, \mu) \ud \mu$ is the current and 
		\begin{equation} \label{eq:eddington} 
			\edd(x) = \frac{\int_{-1}^1 \mu^2 \psi(x, \mu) \ud \mu}{\int_{-1}^1 \psi(x, \mu) \ud \mu} \xrightarrow{\text{S}_N} \frac{\sum_{n=1}^N \mu_n^2 w_n\psi_n(x)}{\sum_{n=1}^N w_n \psi_n(x)}
		\end{equation}
	the Eddington factor. Note that no approximations have been made to arrive at Eqs. \ref{eq:zero} and \ref{eq:first}. The Eddington factor is the true angular flux weighted average of $\mu^2$ and therefore Eqs. \ref{eq:zero} and \ref{eq:first} are just as accurate as Eq. \ref{eq:bte}. 

	This formulation is beneficial because Eq. \ref{eq:zero} is a conservative balance equation and if $\edd(x)$ is known, the moment equations' system of two, first--order ordinary differential equations can be solved directly with well--established methods. However, computing $\edd(x)$ requires already knowing the solution. 

	The proposed acceleration scheme is: 
		\begin{enumerate}
			\item Compute $\psi_n$ with \SN and an arbitrary spatial discretization
			\item Compute $\edd$ with Eq. \ref{eq:eddington}
			\item Interpolate $\edd$ onto the MHFEM grid 
			\item Solve the moment equations with the preconditioned $\edd$ using MHFEM. 
		\end{enumerate}
	Acceleration occurs because the Eddington factor is a weak function of angular flux. This means that even poor angular flux solutions can accurately approximate the Eddington factor. In addition, the moment equations model the contributions of all scattering events at once, reducing the dependence on source iterations to introduce scattering information. The solution from the acceleration step is then an approximation for the full flux and not the $\ell - 1$ collided flux as it was without acceleration. The updated flux is then used on the right hand side of Eq. \ref{eq:si} to produce an even more accurate approximation of $\edd(x)$. 

	This scheme allows the \SN equations and moment equations to be solved with different spatial discretizations. \SN can be discretized using normal methods such as Linear Discontinuous Galerkin or Diamond Differencing while the moment equations can be solved on the same grid as the hydrodynamics. 
	% operator split iteration, computationally economic to use moment equations 

	% This method differs from DSA in that two solutions are generated: one from \SN and one from the moment equations and that the \SN and acceleration steps do not have to be consistently differenced. The solution of the moment equations will be used because the moment equations are conservative while \SN is not. 
	
\section{Results}
	As a proof of concept for Eddington acceleration, a Diamond Differenced \SN code was created in addition to an MHFEM solver for Eqs. \ref{eq:zero} and \ref{eq:first}. The test problem of steady--state, one--group, isotropically--scattering, fixed--source radiation transport in slab geometry with a reflecting left boundary and vacuum right boundary was used to compare unaccelerated, Eddington accelerated and DSA S$_8$ with 100 spatial cells. Figure \ref{fig:comparison} shows the number of iterations until the L$^2$ norm of the flux converged to within a tolerance of \num{1e-6} for varying ratios of $\Sigma_s$ to $\Sigma_t$. 

	\begin{figure}[ht] % replace 't' with 'b' to force it to be on the bottom
	  \centering
	  \includegraphics[width=8.5cm]{accel.pdf}
	  \caption{A comparison of unaccelerated, Eddington accelerated and DSA S$_8$. }
	  \label{fig:comparison}
	\end{figure}

	% add convergence rate of phi v edd 
	% include discussion on acceleration v just doing 2 times as much work. ie actual acceleration is happening 

\section{Conclusions}
	Figure \ref{fig:comparison} suggests that Eddington acceleration is a valid method for accelerating \SN SI calculations. The required iterations until convergence is significantly lower for Eddington accelerated S$_8$. This is especially evident for the pure scattering regime ($\Sigma_s = \Sigma_t$) where S$_8$ was accelerated by a factor of 750. In addition, Eddington acceleration performed as well as DSA. This scheme produces a conservative solution and does not require the \SN and acceleration steps to be consistently differenced. 

\section{Future Work} 


\section{Acknowledgments}

\bibliographystyle{ans}
\bibliography{bibliography.bib}
\end{document}