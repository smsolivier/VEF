\documentclass[10pt]{beamer}

\usetheme[progressbar=frametitle]{metropolis}
\usepackage{appendixnumberbeamer}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}

\usepackage{lmodern}

\usepackage{cancel}

\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\title{Mixed Hybrid Finite Element Method Eddington Acceleration of Discrete Ordinates Source Iteration}
\subtitle{\normalsize American Nuclear Society Student Conference Presentation}
% \date{\today}
\date{\today}
\author{Samuel S. Olivier }
\institute{Department of Nuclear Engineering, Texas A\&M University}
% \titlegraphic{\hfill\includegraphics[height=1.5cm]{nuen-logo.png}}


\newcommand{\SN}{S$_N$\xspace}
\renewcommand{\vec}[1]{\bm{#1}} %vector is bold italic
\newcommand{\vd}{\bm{\cdot}} % slightly bold vector dot
\newcommand{\grad}{\vec{\nabla}} % gradient
\newcommand{\ud}{\mathop{}\!\mathrm{d}} % upright derivative symbol
\newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\dderiv}[2]{\frac{\ud #1}{\ud #2}}
\newcommand{\edd}{\langle \mu^2 \rangle} 
\begin{document}

% make blocks fill 
\metroset{block=fill}

\maketitle

\begin{frame}{Table of contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}

\section{Introduction}

\begin{frame}{Motivation}
    
    Radiation transport simulations are expensive 

    Multiphysics Coupling 
        \begin{itemize}
            \item Operator split requires iteration
            \item Efficient solution methods are often incompatible 
        \end{itemize}

    Radiation Hydrodynamics 
        \begin{itemize}
            \item Mixed Hybrid Finite Element Method for hydro 
            \item Linear Discontinuous Galerkin for transport 
        \end{itemize}

    \begin{block}{Goal}
        Develop an acceleration scheme that 
            \begin{enumerate}
                \item Robustly reduces the number of source iterations in Discrete Ordinates calculations 

                \item Remains compatible with MHFEM multiphysics 
            \end{enumerate}
        Test in 1D slab geometry case
    \end{block}

\end{frame}

\section{Background}

\begin{frame}{Boltzmann Equation}
    Steady-state, mono-energetic, istropically-scattering, fixed-source Linear Boltzmann Equation in 1D slab geometry:
    \begin{equation*}
        \mu \pderiv{\psi}{x}(x, \mu) + \Sigma_t(x) \psi(x,\mu) = 
        \frac{\Sigma_s(x)}{2} \int_{-1}^{1} \psi(x, \mu') d\mu' + \frac{Q(x)}{2}
    \end{equation*}

    $\mu = \cos \theta$ the cosine of the angle of flight $\theta$ relative to the $x$-axis

    $\Sigma_t(x)$, $\Sigma_s(x)$ total and scattering macroscopic cross sections 

    $Q(x)$ the isotropic fixed-source

    $\psi(x,\mu)$ the angular flux 

    Factors of 1/2 come from 
        \begin{equation*}
            \phi(x) = \int_{-1}^{1} \psi(x,\mu) \ud \mu
        \end{equation*}

    \textbf{Integro-differential equation}

\end{frame}

\begin{frame}{Discrete Ordinates Angular Discretization}

    Compute angular flux on $N$ discrete angles 
        \begin{equation*}
            \psi(x,\mu) \xrightarrow{\text{S}_N} 
            \begin{cases}
                \psi_1(x), & \mu = \mu_1 \\ 
                \psi_2(x), & \mu = \mu_2 \\ 
                \vdots \\ 
                \psi_N, & \mu = \mu_N 
            \end{cases}
        \end{equation*}

    $\mu_1$, $\mu_2$, $\dots$, $\mu_N$ defined by N-point Gauss Quadrature Rule 

    \begin{equation*}
        \phi(x) = \int_{-1}^1 \psi(x, \mu) \ud\mu 
            \xrightarrow{\text{S}_N} \sum_{n=1}^N w_n \psi_n(x)
    \end{equation*}

\end{frame}

\begin{frame}{\SN Equations}

    \begin{equation*}
        \mu_n \dderiv{\psi_n}{x}(x) + \Sigma_t(x) \psi_n(x) = 
        \frac{\Sigma_s(x)}{2} \phi(x) + \frac{Q(x)}{2} \,, \, 1 \leq n \leq N
    \end{equation*}

    \begin{equation*}
        \phi(x) = \sum_{n=1}^N w_n \psi_n(x)
    \end{equation*}

    \textbf{$N$ coupled, ordinary differential equations}

\end{frame}

\begin{frame}{Source Iteration}

    Lag scattering term 

    \begin{equation*}
        \mu_n \dderiv{\psi_n^{\ell+1}}{x}(x) + \Sigma_t(x) \psi_n^{\ell+1}(x) = 
        \frac{\Sigma_s(x)}{2} \phi^{\ell}(x) + \frac{Q(x)}{2} \,, 1 \leq n \leq N        
    \end{equation*}

    \begin{exampleblock}{Source Iteration}
    \begin{enumerate}
        \item Given previous estimate for $\phi^{\ell}(x)$, solve for $\psi_n^{\ell+1}$

        \item Compute $\phi^{\ell+1}(x) = 
            \sum_{n=1}^N w_n \psi_n^{\ell+1}(x)$ 

        \item Update scattering term with $\phi^{\ell+1}(x)$ and repeat until: 
             \begin{equation*}
                \frac{\|\phi^{\ell+1}(x) - \phi^{\ell}(x)\|}{\|\phi^{\ell+1}(x)\|} < \epsilon 
             \end{equation*}

    \end{enumerate}
    \end{exampleblock}

    \textbf{$N$ independent, first-order, ordinary differential equations}

\end{frame}

\begin{frame}{Need For Acceleration in Source Iteration}

	Convergence rate is linked to the number of collisions in a particle's lifetime

    If $\phi^0(x) = 0$
    % add arrow through phi_0
    \begin{equation*}
        \mu_n \dderiv{\psi_n^{1}}{x}(x) + \Sigma_t(x) \psi_n^{1}(x) =
        \cancelto{0}{\frac{\Sigma_s(x)}{2} \phi^{0}(x)} + \frac{Q(x)}{2} \,, 1 \leq n \leq N 
    \end{equation*}      

    $\Rightarrow \phi^1(x) $ is the uncollided flux 

    Each source iteration adds scattering information 

    $\phi^{\ell}(x)$ is the scalar flux of particles that have undergone at most $\ell - 1$ collisions 

    \textbf{Slow to converge in optically thick systems with minimal losses to absorption and leakage}

\end{frame}

\begin{frame}{Diffusion Synthetic Acceleration}

    Large, highly scattering systems $\Rightarrow$ Diffusion Theory is accurate! 

    % bold acceleration additions

    \begin{exampleblock}{Diffusion Synthetic Acceleration}
    \begin{enumerate}
        \item Given previous estimate for $\phi^{\ell}(x)$, solve for $\psi_n^{\ell+1/2}$

        \item Compute $\phi^{\ell+1/2}(x) = 
            \sum_{n=1}^N w_n \psi_n^{\ell+1/2}(x)$ 

        \item \alert{Solve diffusion equation for a correction factor, $f^{\ell+1}(x)$}

        \item Update scattering term with 
            $\alert{\phi^{\ell+1}(x) = \phi^{\ell+1/2}(x) + f^{\ell+1}(x)}$ 
        and repeat until: 
             \begin{equation*}
                \frac{\|\phi^{\ell+1}(x) - \phi^{\ell}(x)\|}{\|\phi^{\ell+1}(x)\|} < \epsilon 
             \end{equation*}

    \end{enumerate}
    \end{exampleblock}

\end{frame}

\begin{frame}{DSA Problems}

    Transport and Diffusion steps must be consistenly differenced to prevent non-convergence 

    Consistently differenced diffusion is much more expensive to solve 

    Transport and MHFEM are not compatible

    \onslide<2>
    \vfill 
    \centerline{\textbf{A new acceleration scheme is needed!}}

\end{frame}

\section{Eddington Acceleration}

\input{zeroMoment}

\input{firstMoment}

\begin{frame}{Drift Diffusion Equation}

	Combining the zeroth and first moments 

	\begin{equation*}
		-\dderiv{}{x} \frac{1}{\Sigma_t(x)} \dderiv{}{x} \edd(x) \phi(x) + \Sigma_a(x) \phi(x) = Q(x) 
	\end{equation*}

	Diffusion Equation is recovered if $\edd(x) = \frac{1}{3}$
	
\end{frame}

\begin{frame}{Eddington Acceleration}

    Use \SN to compute $\edd(x)$ and Drift Diffusion to find $\phi(x)$ 

    \begin{exampleblock}{Eddington Acceleration}
    \begin{enumerate}
        \item Given the previous estimate for the scalar flux, $\phi^{\ell}(x)$, solve for $\psi_n^{\ell+1/2}(x)$

        \item \alert{Compute $\edd^{\ell+1/2}(x)$ }

        \item \alert{Solve the Drift Diffusion Equation for $\phi^{\ell+1}(x)$ using $\edd^{\ell+1/2}(x)$} 

        \item Update the scalar flux estimate with $\phi^{\ell+1}(x)$ and repeat the iteration process until the scalar flux converges
    \end{enumerate}
    \end{exampleblock}

\end{frame}

\begin{frame}{Eddington Acceleration Properties}
    
    Acceleration occurs due to: 
    \begin{enumerate}
    	\item Angular shape of the angular flux converges quickly $\Rightarrow$ Eddington factor quickly converges 

    	\item Solution to moment equations models all scattering events at once 

    	\item Dependence on source iterations to introduce scattering information is reduced

    \end{enumerate}

    Downside: produces 2 solutions (\SN and Drift Diffusion)

    Benefits 
    \begin{enumerate}
        \item Moment Equations are conservative 

        \item Transport and Acceleration steps can be differenced with arbitrarily different methods 

        \item Accelerates source iterations 

        \item Difference between \SN and Drift Diffusion solution can be used as a measure of iteration uncertainty 

    \end{enumerate}

\end{frame}

\section{Results}

\begin{frame}{Test Problem} 

	

\end{frame}

\begin{frame}[standout]
  Questions?
\end{frame}

\appendix

\begin{frame}[fragile]{Backup slides}
  Sometimes, it is useful to add slides at the end of your presentation to
  refer to during audience questions.

  The best way to do this is to include the \verb|appendixnumberbeamer|
  package in your preamble and call \verb|\appendix| before your backup slides.

  \themename will automatically turn off slide numbering and progress bars for
  slides in the appendix.
\end{frame}

\begin{frame}[allowframebreaks]{References}

  \bibliography{demo}
  \bibliographystyle{abbrv}

\end{frame}

\end{document}
